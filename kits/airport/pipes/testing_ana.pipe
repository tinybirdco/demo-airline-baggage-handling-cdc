NODE total_passengers_by_flight
SQL >

    SELECT flight_id, count(id) as total_passengers FROM passengers_latest final
    group by flight_id



NODE total_onboarder
SQL >

    SELECT updated_at, flight_id, countIf(id) as total_passengers_onboarder FROM passengers_latest final
    where status = 'onboarded'
    group by updated_at, flight_id
    order by flight_id



NODE flight_details
SQL >

    SELECT id as flight_id, passenger_count as expected_passengers FROM flights_latest final



NODE testing_ana_2
SQL >

    select
        a.flight_id as flight_id,
        c.expected_passengers as expected_passengers,
        a.total_passengers as passengers,
        b.total_passengers_onboarder as passengers_onboarder
    from total_passengers_by_flight a any
    left join total_onboarder b using flight_id any
    left join flight_details c on a.flight_id = c.flight_id


